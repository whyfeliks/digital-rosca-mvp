# üìê –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: Digital ROSCA MVP

## üéØ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

**–ù–∞–∑–≤–∞–Ω–∏–µ**: Digital ROSCA (Rotating Savings and Credit Association)  
**–¢–∏–ø**: –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (SPA)  
**–¶–µ–ª—å**: MVP –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑—ã –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–∏—Ñ—Ä–æ–≤—ã–µ –¥–µ–Ω–µ–∂–Ω—ã–µ –∫—Ä—É–≥–∏

---

## üß† –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è ROSCA

ROSCA ‚Äî —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –≤–∑–∞–∏–º–Ω–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–∏—è, –≥–¥–µ:
1. –ì—Ä—É–ø–ø–∞ –∏–∑ N —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤–Ω–æ—Å–∏—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—É–º–º—É S –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (–Ω–µ–¥–µ–ª—è/–º–µ—Å—è—Ü)
2. –ö–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ –æ–¥–∏–Ω —É—á–∞—Å—Ç–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –≤—Å—é –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é —Å—É–º–º—É (N √ó S)
3. –ü–æ—Ä—è–¥–æ–∫ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∏–ª–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ–º
4. –¶–∏–∫–ª –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –≤—Å–µ N —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ–ª—É—á–∞—Ç –≤—ã–ø–ª–∞—Ç—É

**–ü—Ä–∏–º–µ—Ä**:
- 5 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ √ó 5,000 ‚ÇΩ = 25,000 ‚ÇΩ –≤—ã–ø–ª–∞—Ç–∞ –∑–∞ —Ä–∞—É–Ω–¥
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 5 –º–µ—Å—è—Ü–µ–≤
- –ö–∞–∂–¥—ã–π –≤–Ω–æ—Å–∏—Ç 25,000 ‚ÇΩ –∏ –ø–æ–ª—É—á–∞–µ—Ç 25,000 ‚ÇΩ
- –ü–µ—Ä–≤—ã–π –ø–æ–ª—É—á–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –¥–µ–Ω—å–≥–∞–º —Å—Ä–∞–∑—É (–±–µ—Å–ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π –∑–∞–µ–º)
- –ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ–ª—É—á–∞—Ç–µ–ª—å –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç —á–µ—Ä–µ–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É (–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞)

---

## üìä –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

#### 1.1 –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- **Input**: Email, Password, Full Name
- **Validation**:
  - Email: —Ñ–æ—Ä–º–∞—Ç RFC 5322
  - Password: –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
  - Name: –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞
- **Output**: User ID, JWT Token
- **Error handling**:
  - Email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí 409 Conflict
  - –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí 400 Bad Request

#### 1.2 –í—Ö–æ–¥
- **Input**: Email, Password
- **Process**:
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ email –≤ –ë–î
  - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ö–µ—à–∞ –ø–∞—Ä–æ–ª—è (bcrypt)
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–∞
- **Output**: User object, JWT Token
- **Session**: 7 –¥–Ω–µ–π

#### 1.3 –†–æ–ª–∏
| –†–æ–ª—å | –î–æ—Å—Ç—É–ø |
|------|--------|
| `user` | –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø, –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –≤–∑–Ω–æ—Å—ã, –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö |
| `admin` | –í—Å—ë + —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—É–Ω–¥–∞–º–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |

---

### 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏ (CRUD)

#### 2.1 –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
```javascript
POST /api/groups
Headers: { Authorization: Bearer <token> }
Body: {
  name: string,              // –ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
  maxParticipants: number,   // 3-20
  contributionAmount: number, // >= 100
  frequency: "weekly" | "monthly",
  startDate: ISO8601         // >= today
}

Response: {
  id: string,
  creatorId: string,
  participants: [creatorId],
  payoutOrder: [],
  currentRound: 1,
  status: "waiting",
  ...–æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
}
```

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞**:
- –°–æ–∑–¥–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º
- –°—Ç–∞—Ç—É—Å = "waiting" –¥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
- payoutOrder —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ maxParticipants

#### 2.2 –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –≥—Ä—É–ø–ø–µ
```javascript
POST /api/groups/{groupId}/join
Headers: { Authorization: Bearer <token> }

Response: { success: true, group: {...} }
```

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞**:
- –ü—Ä–æ–≤–µ—Ä–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â—ë –Ω–µ —É—á–∞—Å—Ç–Ω–∏–∫
- –ü—Ä–æ–≤–µ—Ä–∫–∞: –≥—Ä—É–ø–ø–∞ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞: —Å—Ç–∞—Ç—É—Å = "waiting"
- –ü—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏:
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è payoutOrder (—Å–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫)
  - –°—Ç–∞—Ç—É—Å ‚Üí "active"
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º

#### 2.3 –ü—Ä–æ—Å–º–æ—Ç—Ä –≥—Ä—É–ø–ø
```javascript
GET /api/groups?filter=all|my|available&page=1&limit=20
Headers: { Authorization: Bearer <token> }

Response: {
  data: [...groups],
  total: number,
  page: number,
  limit: number
}
```

**–§–∏–ª—å—Ç—Ä—ã**:
- `all` ‚Äî –≤—Å–µ –≥—Ä—É–ø–ø—ã
- `my` ‚Äî –≥–¥–µ —è —É—á–∞—Å—Ç–Ω–∏–∫
- `available` ‚Äî status="waiting" –ò —è –Ω–µ —É—á–∞—Å—Ç–Ω–∏–∫ –ò –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞

---

### 3. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

#### 3.1 –í–Ω–µ—Å–µ–Ω–∏–µ –≤–∑–Ω–æ—Å–∞
```javascript
POST /api/groups/{groupId}/contribute
Headers: { Authorization: Bearer <token> }

Response: {
  transactionId: string,
  newBalance: number
}
```

**–ü—Ä–æ—Ü–µ—Å—Å**:
1. –ü—Ä–æ–≤–µ—Ä–∫–∏:
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Äî —É—á–∞—Å—Ç–Ω–∏–∫ –≥—Ä—É–ø–ø—ã
   - –ì—Ä—É–ø–ø–∞ –∞–∫—Ç–∏–≤–Ω–∞ (status="active")
   - –í–∑–Ω–æ—Å –µ—â—ë –Ω–µ –≤–Ω–µ—Å—ë–Ω –≤ —Ç–µ–∫—É—â–µ–º —Ä–∞—É–Ω–¥–µ
   - –ë–∞–ª–∞–Ω—Å >= contributionAmount
2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (type="contribution")
3. –°–ø–∏—Å–∞–Ω–∏–µ —Å –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –ü—Ä–æ–≤–µ—Ä–∫–∞: –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –≤–Ω–µ—Å–ª–∏ ‚Üí –≥–æ—Ç–æ–≤ –∫ –≤—ã–ø–ª–∞—Ç–µ
5. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

#### 3.2 –í—ã–ø–ª–∞—Ç–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è/–∞–¥–º–∏–Ω)
```javascript
POST /api/groups/{groupId}/payout
Headers: { Authorization: Bearer <admin-token> }

Response: {
  payoutTransaction: {...},
  nextRound: number,
  status: "active" | "completed"
}
```

**–ü—Ä–æ—Ü–µ—Å—Å**:
1. –ü—Ä–æ–≤–µ—Ä–∫–∏:
   - –í—Å–µ –≤–∑–Ω–æ—Å—ã —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞—É–Ω–¥–∞ –≤–Ω–µ—Å–µ–Ω—ã
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è –∏–∑ payoutOrder[currentRound - 1]
2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (type="payout")
3. –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ –±–∞–ª–∞–Ω—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è
4. –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–∞—É–Ω–¥—É:
   - currentRound++
   - –ï—Å–ª–∏ currentRound > maxParticipants ‚Üí status="completed"
   - –†–∞—Å—á—ë—Ç nextPayoutDate (+ frequency)
5. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º

#### 3.3 –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
```javascript
GET /api/transactions?userId={id}&groupId={id}&type={type}
Headers: { Authorization: Bearer <token> }

Response: {
  data: [...transactions],
  total: number
}
```

---

### 4. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
| –¢–∏–ø | –¢—Ä–∏–≥–≥–µ—Ä | –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ |
|-----|---------|------------|
| `contribution_reminder` | 3 –¥–Ω—è –¥–æ nextPayoutDate | –£—á–∞—Å—Ç–Ω–∏–∫–∏ –±–µ–∑ –≤–∑–Ω–æ—Å–∞ |
| `payout_received` | –í—ã–ø–ª–∞—Ç–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–∞ | –ü–æ–ª—É—á–∞—Ç–µ–ª—å |
| `round_completed` | –†–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à—ë–Ω | –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ |
| `group_started` | –ì—Ä—É–ø–ø–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ | –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ |
| `group_filled` | –ù–æ–≤—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ | –°–æ–∑–¥–∞—Ç–µ–ª—å |

#### API:
```javascript
GET /api/notifications?isRead=false
Headers: { Authorization: Bearer <token> }

Response: { data: [...notifications] }

PATCH /api/notifications/{id}
Body: { isRead: true }
```

---

### 5. –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

#### 5.1 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```javascript
GET /api/admin/stats
Headers: { Authorization: Bearer <admin-token> }

Response: {
  totalUsers: number,
  totalGroups: number,
  activeGroups: number,
  completedGroups: number,
  totalTransactions: number,
  totalVolume: number  // –°—É–º–º–∞ –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
}
```

#### 5.2 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
```javascript
GET /api/admin/users?page=1&limit=50&search=email
Response: { data: [...users], total }

PATCH /api/admin/users/{id}
Body: { balance: number, role: "user"|"admin" }
```

#### 5.3 –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ —Ä–∞—É–Ω–¥–∞
```javascript
POST /api/admin/groups/{groupId}/force-next-round
Body: { skipValidation: boolean }  // –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–∑–Ω–æ—Å–æ–≤

Response: { success: true, nextRound: number }
```

---

## üóÑÔ∏è –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

### Entity Relationship Diagram

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Users     ‚îÇ         ‚îÇ    Groups    ‚îÇ         ‚îÇ  Transactions  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id          ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ id           ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ id             ‚îÇ
‚îÇ name        ‚îÇ        ‚îÇ‚îÇ name         ‚îÇ        ‚îÇ‚îÇ groupId (FK)   ‚îÇ
‚îÇ email       ‚îÇ        ‚îÇ‚îÇ creatorId(FK)‚îÇ        ‚îÇ‚îÇ fromUserId(FK) ‚îÇ
‚îÇ passwordHash‚îÇ        ‚îÇ‚îÇ participants ‚îÇ        ‚îÇ‚îÇ toUserId (FK)  ‚îÇ
‚îÇ balance     ‚îÇ        ‚îÇ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îÇ‚îÇ amount         ‚îÇ
‚îÇ role        ‚îÇ        ‚îÇ                        ‚îÇ‚îÇ round          ‚îÇ
‚îÇ joinedGroups‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                        ‚îÇ‚îÇ type           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                 ‚îÇ‚îÇ status         ‚îÇ
                                                 ‚îÇ‚îÇ createdAt      ‚îÇ
                                                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –°—Ö–µ–º—ã —Ç–∞–±–ª–∏—Ü

#### `users`
```sql
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(100) NOT NULL,
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  balance DECIMAL(12,2) DEFAULT 0.00,
  role VARCHAR(20) DEFAULT 'user',
  joined_groups JSONB DEFAULT '[]',
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_role ON users(role);
```

#### `groups`
```sql
CREATE TABLE groups (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(200) NOT NULL,
  creator_id UUID REFERENCES users(id),
  participants JSONB DEFAULT '[]',
  contribution_amount DECIMAL(12,2) NOT NULL,
  max_participants INT NOT NULL CHECK (max_participants BETWEEN 3 AND 20),
  payout_order JSONB DEFAULT '[]',
  frequency VARCHAR(20) CHECK (frequency IN ('weekly', 'monthly')),
  current_round INT DEFAULT 1,
  status VARCHAR(20) DEFAULT 'waiting',
  start_date TIMESTAMP NOT NULL,
  next_payout_date TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_groups_status ON groups(status);
CREATE INDEX idx_groups_creator ON groups(creator_id);
CREATE INDEX idx_groups_participants ON groups USING GIN (participants);
```

#### `transactions`
```sql
CREATE TABLE transactions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  group_id UUID REFERENCES groups(id) ON DELETE CASCADE,
  from_user_id UUID REFERENCES users(id),
  to_user_id UUID REFERENCES users(id),
  amount DECIMAL(12,2) NOT NULL,
  round INT NOT NULL,
  type VARCHAR(20) CHECK (type IN ('contribution', 'payout')),
  status VARCHAR(20) DEFAULT 'completed',
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_transactions_group ON transactions(group_id);
CREATE INDEX idx_transactions_from_user ON transactions(from_user_id);
CREATE INDEX idx_transactions_to_user ON transactions(to_user_id);
CREATE INDEX idx_transactions_type ON transactions(type);
```

#### `notifications`
```sql
CREATE TABLE notifications (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  title VARCHAR(200) NOT NULL,
  message TEXT NOT NULL,
  type VARCHAR(50) NOT NULL,
  is_read BOOLEAN DEFAULT false,
  group_id UUID REFERENCES groups(id) ON DELETE SET NULL,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_notifications_user ON notifications(user_id);
CREATE INDEX idx_notifications_is_read ON notifications(is_read);
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **JWT Tokens**: HS256 –∞–ª–≥–æ—Ä–∏—Ç–º
- **Payload**:
  ```json
  {
    "userId": "uuid",
    "email": "user@example.com",
    "role": "user",
    "iat": 1234567890,
    "exp": 1234567890
  }
  ```
- **Refresh Tokens**: –•—Ä–∞–Ω–∏—Ç—å –≤ httpOnly cookies
- **Token lifetime**: 7 –¥–Ω–µ–π (access), 30 –¥–Ω–µ–π (refresh)

### –ü–∞—Ä–æ–ª–∏
- **Hashing**: bcrypt —Å cost factor = 10
- **Validation**: –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤, 1 –±—É–∫–≤–∞, 1 —Ü–∏—Ñ—Ä–∞
- **Reset**: Email —Å –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–π —Å—Å—ã–ª–∫–æ–π (TTL 1 —á–∞—Å)

### API Security
- **Rate Limiting**: 100 req/min –Ω–∞ IP
- **CORS**: –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ production –¥–æ–º–µ–Ω
- **HTTPS**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤ production
- **SQL Injection**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- **XSS**: –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö input'–æ–≤

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- **Time to First Byte (TTFB)**: < 200ms
- **First Contentful Paint (FCP)**: < 1.5s
- **Time to Interactive (TTI)**: < 3s
- **API Response Time**: < 300ms (p95)

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

#### Frontend
- –ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è CSS/JS (webpack/rollup)
- Code splitting –ø–æ —Ä–æ—É—Ç–∞–º
- Lazy loading –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- Service Worker –¥–ª—è offline
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫–∏ (1 –≥–æ–¥)

#### Backend
- –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ –≤—Å–µ—Ö FK –∏ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –ø–æ–ª—è—Ö
- Connection pooling (PostgreSQL)
- Redis –¥–ª—è –∫–µ—à–∞:
  - User sessions (JWT blacklist)
  - Group lists (TTL 5 min)
  - Statistics (TTL 15 min)
- CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ (CloudFlare/AWS CloudFront)

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ `transactions` –ø–æ created_at (–µ–∂–µ–º–µ—Å—è—á–Ω–æ)
- –ê—Ä—Ö–∏–≤–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø (status='completed', >6 –º–µ—Å—è—Ü–µ–≤)
- Read replicas –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit Tests
```javascript
// –ü—Ä–∏–º–µ—Ä: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—á—ë—Ç–∞ –≤—ã–ø–ª–∞—Ç—ã
describe('Group.calculatePayout', () => {
  it('should calculate correct payout amount', () => {
    const group = {
      contributionAmount: 5000,
      maxParticipants: 5
    };
    expect(calculatePayout(group)).toBe(25000);
  });
});
```

### Integration Tests
```javascript
describe('POST /api/groups/:id/contribute', () => {
  it('should create contribution and update balance', async () => {
    const user = await createTestUser({ balance: 10000 });
    const group = await createTestGroup();
    
    const res = await request(app)
      .post(`/api/groups/${group.id}/contribute`)
      .set('Authorization', `Bearer ${user.token}`)
      .expect(200);
    
    expect(res.body.newBalance).toBe(5000);
  });
});
```

### E2E Tests (Playwright)
```javascript
test('complete ROSCA cycle', async ({ page }) => {
  // 1. –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
  await page.goto('/groups');
  await page.click('#createGroupBtn');
  await page.fill('#groupName', 'Test Group');
  await page.click('button[type=submit]');
  
  // 2. –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
  for (let i = 0; i < 4; i++) {
    await loginAs(`user${i}@test.com`);
    await page.click('.btn-join');
  }
  
  // 3. –í–Ω–µ—Å–µ–Ω–∏–µ –≤–∑–Ω–æ—Å–æ–≤
  // ...
  
  // 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–ª–∞—Ç—ã
  await expect(page.locator('.balance')).toContainText('25,000');
});
```

---

## üì¶ –î–µ–ø–ª–æ–π –∏ DevOps

### CI/CD Pipeline (GitHub Actions)

```yaml
name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: npm ci
      - run: npm test
      - run: npm run test:e2e

  build:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - run: npm run build
      - run: docker build -t rosca-app .
      - run: docker push rosca-app:latest

  deploy:
    needs: build
    runs-on: ubuntu-latest
    steps:
      - run: kubectl apply -f k8s/
      - run: kubectl rollout status deployment/rosca-app
```

### Docker Setup

#### Dockerfile (Backend)
```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
EXPOSE 3000
CMD ["node", "server.js"]
```

#### docker-compose.yml (Development)
```yaml
version: '3.8'
services:
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: rosca_dev
      POSTGRES_PASSWORD: dev_pass
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    
  backend:
    build: ./backend
    ports:
      - "3000:3000"
    environment:
      DATABASE_URL: postgresql://postgres:dev_pass@postgres:5432/rosca_dev
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis

volumes:
  postgres_data:
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

#### –ú–µ—Ç—Ä–∏–∫–∏ (Prometheus)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–ø–ø –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
- –°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –≤–∑–Ω–æ—Å–∞
- Rate —É—Å–ø–µ—à–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- API latency (p50, p95, p99)
- Error rate –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (ELK Stack)
```javascript
// Winston logger
const logger = winston.createLogger({
  format: winston.format.json(),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
});

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
logger.info('User joined group', {
  userId: user.id,
  groupId: group.id,
  timestamp: Date.now()
});
```

#### –ê–ª–µ—Ä—Ç—ã (PagerDuty/Slack)
- Error rate > 1% ‚Üí P1 alert
- API latency p95 > 1s ‚Üí P2 alert
- Disk usage > 80% ‚Üí P3 alert
- Suspicious transaction patterns ‚Üí Security alert

---

## üåê API Endpoints Summary

### Public
```
POST   /api/auth/register
POST   /api/auth/login
POST   /api/auth/refresh
POST   /api/auth/forgot-password
POST   /api/auth/reset-password
```

### Authenticated
```
GET    /api/user/profile
PATCH  /api/user/profile
GET    /api/user/balance
GET    /api/user/transactions

GET    /api/groups
POST   /api/groups
GET    /api/groups/:id
PATCH  /api/groups/:id
DELETE /api/groups/:id
POST   /api/groups/:id/join
POST   /api/groups/:id/contribute

GET    /api/transactions
GET    /api/transactions/:id

GET    /api/notifications
PATCH  /api/notifications/:id
DELETE /api/notifications/:id
```

### Admin Only
```
GET    /api/admin/stats
GET    /api/admin/users
PATCH  /api/admin/users/:id
GET    /api/admin/groups
POST   /api/admin/groups/:id/force-next-round
GET    /api/admin/transactions
```

---

## üì± –ë—É–¥—É—â–∏–µ —Ñ–∏—á–∏ (Post-MVP)

### –§–∞–∑–∞ 2: –ü–ª–∞—Ç–µ–∂–∏
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è YooKassa/Stripe
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- [ ] Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
- [ ] –í–æ–∑–≤—Ä–∞—Ç—ã –∏ —Å–ø–æ—Ä—ã

### –§–∞–∑–∞ 3: –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- [ ] –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç (Socket.io)
- [ ] –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º
- [ ] –û—Ç–∑—ã–≤—ã –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ü–∏–∫–ª–∞
- [ ] –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –ø–æ email/SMS

### –§–∞–∑–∞ 4: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- [ ] Dashboard –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≥—Ä—É–ø–ø—ã
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (CSV, PDF)
- [ ] –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- [ ] –ì—Ä–∞—Ñ–∏–∫–∏ –≤–∑–Ω–æ—Å–æ–≤/–≤—ã–ø–ª–∞—Ç

### –§–∞–∑–∞ 5: –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] React Native iOS/Android
- [ ] Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (FCM)
- [ ] –ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- [ ] Offline mode

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∫–æ–º–∞–Ω–¥—ã

**Product Manager**: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –±–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è  
**Backend Developer**: Node.js/Express + PostgreSQL  
**Frontend Developer**: React + TailwindCSS  
**DevOps Engineer**: AWS/Docker/Kubernetes  
**QA Engineer**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è  

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2024-10-27  
**–°—Ç–∞—Ç—É—Å**: MVP Ready
